import{d as e,c as a,e as t,k as l,g as s,L as i,x as n,u as o,p as d,y as r,r as c,f as u,M as v,N as p,O as g,o as y,j as b,m as _,P as k,F as m}from"./vendor-B0DAOtER.js";import{_ as w,i as f,c as h,f as C}from"./index-CGWH-pHj.js";import{M as I}from"./Modal-Bzr7RJEW.js";import"./utils-ei4kQ0Q2.js";import"./charts-BZyKnHge.js";const S=["type","disabled"],T={key:0,class:"btn__spinner","aria-hidden":"true"},x=w(e({__name:"Button",props:{variant:{default:"primary"},size:{default:"md"},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},type:{default:"button"},block:{type:Boolean,default:!1}},emits:["click"],setup(e,{emit:o}){const d=e,r=o,c=a(()=>{const e=["btn",`btn--${d.variant}`,`btn--${d.size}`];return(d.disabled||d.loading)&&e.push("btn--disabled"),d.block&&e.push("btn--block"),d.loading&&e.push("btn--loading"),e}),u=e=>{d.disabled||d.loading||r("click",e)};return(a,o)=>(n(),t("button",{class:l(c.value),type:e.type,disabled:e.disabled||e.loading,onClick:u},[e.loading?(n(),t("span",T)):s("",!0),i(a.$slots,"default",{},void 0)],10,S))}}),[["__scopeId","data-v-7d3c0959"]]),D=["title"],B=w(e({__name:"StatusBadge",props:{status:{},size:{default:"md"}},setup(e){const a={open:{label:"Open",colorClass:"status-open"},acknowledged:{label:"Acknowledged",colorClass:"status-acknowledged"},resolved:{label:"Resolved",colorClass:"status-resolved"}}[s=e.status]||{label:s.charAt(0).toUpperCase()+s.slice(1),colorClass:"status-default"};var s;return(s,i)=>(n(),t("span",{class:l(["status-badge",`status-badge--${e.size}`,o(a).colorClass]),title:`Status: ${o(a).label}`},d(o(a).label),11,D))}}),[["__scopeId","data-v-ba203988"]]),z=["title"],A={key:0,class:"severity-badge__icon","aria-hidden":"true"},$=w(e({__name:"SeverityBadge",props:{severity:{},size:{default:"md"},showIcon:{type:Boolean,default:!1}},setup(e){const a={critical:{label:"Critical",colorClass:"severity-critical",icon:"ðŸ”´"},high:{label:"High",colorClass:"severity-high",icon:"ðŸŸ "},medium:{label:"Medium",colorClass:"severity-medium",icon:"ðŸŸ¡"},low:{label:"Low",colorClass:"severity-low",icon:"ðŸ”µ"},info:{label:"Info",colorClass:"severity-info",icon:"âšª"}}[i=e.severity]||{label:i.charAt(0).toUpperCase()+i.slice(1),colorClass:"severity-default",icon:"âš«"};var i;return(i,c)=>(n(),t("span",{class:l(["severity-badge",`severity-badge--${e.size}`,o(a).colorClass]),title:`Severity: ${o(a).label}`},[e.showIcon?(n(),t("span",A,d(o(a).icon),1)):s("",!0),r(" "+d(o(a).label),1)],10,z))}}),[["__scopeId","data-v-6bae7d16"]]),Z={class:"table-container"},O={class:"data-table__head"},j=["onClick"],L={class:"data-table__header-content"},M={class:"data-table__body"},R={key:0},E=["colspan"],F={key:1},N=["colspan"],P=["onClick"],U=w(e({__name:"DataTable",props:{columns:{},data:{},loading:{type:Boolean,default:!1},emptyMessage:{default:"No data available"},sortBy:{default:null},sortOrder:{default:"asc"},hoverable:{type:Boolean,default:!0},striped:{type:Boolean,default:!1},bordered:{type:Boolean,default:!1},compact:{type:Boolean,default:!1}},emits:["sort","rowClick"],setup(e,{emit:o}){const y=e,b=o,_=c(y.sortBy),k=c(y.sortOrder),m=a(()=>{const e=["data-table"];return y.hoverable&&e.push("data-table--hoverable"),y.striped&&e.push("data-table--striped"),y.bordered&&e.push("data-table--bordered"),y.compact&&e.push("data-table--compact"),e}),w=a(()=>_.value?[...y.data].sort((e,a)=>{const t=_.value;if("string"==typeof t&&!(t in e))return 0;const l=e[t],s=a[t];let i=0;return l<s?i=-1:l>s&&(i=1),"desc"===k.value?-1*i:i}):y.data),f=e=>e.sortable?_.value!==e.key?"â†•ï¸":"asc"===k.value?"â†‘":"â†“":"",h=(e,a)=>{const t=e.key;if("string"==typeof t&&!(t in a))return"";const l=a[t];return e.formatter?e.formatter(l,a):String(l||"")};return(a,o)=>(n(),t("div",Z,[u("table",{class:l(m.value)},[u("thead",O,[u("tr",null,[(n(!0),t(v,null,p(e.columns,e=>(n(),t("th",{key:String(e.key),class:l(["data-table__header",`data-table__header--${e.align||"left"}`,{"data-table__header--sortable":e.sortable}]),style:g({width:e.width}),onClick:a=>(e=>{if(!e.sortable)return;const a=e.key;_.value===a?k.value="asc"===k.value?"desc":"asc":(_.value=a,k.value="asc"),b("sort",a,k.value)})(e)},[u("div",L,[r(d(e.label)+" ",1),e.sortable?(n(),t("span",{key:0,class:l(["data-table__sort-icon",{"data-table__sort-icon--active":_.value===e.key}])},d(f(e)),3)):s("",!0)])],14,j))),128))])]),u("tbody",M,[e.loading?(n(),t("tr",R,[u("td",{colspan:e.columns.length,class:"data-table__loading"},[...o[0]||(o[0]=[u("div",{class:"loading-spinner"},null,-1),r(" Loading... ",-1)])],8,E)])):0===w.value.length?(n(),t("tr",F,[u("td",{colspan:e.columns.length,class:"data-table__empty"},d(e.emptyMessage),9,N)])):(n(!0),t(v,{key:2},p(w.value,(s,o)=>(n(),t("tr",{key:o,class:"data-table__row",onClick:e=>((e,a)=>{b("rowClick",e,a)})(s,o)},[(n(!0),t(v,null,p(e.columns,e=>(n(),t("td",{key:String(e.key),class:l(["data-table__cell",`data-table__cell--${e.align||"left"}`])},[i(a.$slots,`cell-${String(e.key)}`,{row:s,column:e,value:"string"!=typeof e.key||e.key in s?s[e.key]:void 0,index:o},()=>[r(d(h(e,s)),1)])],2))),128))],8,P))),128))])],2)]))}}),[["__scopeId","data-v-33df6946"]]),H=[{id:"inc-001-2024",title:"Database Connection Timeout",description:"Multiple database connection timeouts reported in the production environment.",severity:"critical",status:"open",assignee_id:"user123",created_at:"2024-01-15T10:30:00Z",updated_at:"2024-01-15T10:30:00Z",labels:{environment:"production",service:"database",priority:"urgent"}},{id:"inc-002-2024",title:"API Rate Limit Exceeded",description:"External API calls are being rate limited, affecting user experience.",severity:"high",status:"acknowledged",assignee_id:"user456",created_at:"2024-01-15T09:15:00Z",updated_at:"2024-01-15T11:00:00Z",acknowledged_at:"2024-01-15T11:00:00Z",labels:{environment:"production",service:"api",component:"rate-limiter"}},{id:"inc-003-2024",title:"Memory Usage Alert",description:"Application memory usage has exceeded 85% threshold.",severity:"medium",status:"resolved",assignee_id:"user789",created_at:"2024-01-14T14:20:00Z",updated_at:"2024-01-14T16:45:00Z",acknowledged_at:"2024-01-14T14:30:00Z",resolved_at:"2024-01-14T16:45:00Z",labels:{environment:"production",service:"application",type:"performance"}},{id:"inc-004-2024",title:"SSL Certificate Expiring",description:"SSL certificate for the main domain will expire in 7 days.",severity:"low",status:"open",created_at:"2024-01-13T08:00:00Z",updated_at:"2024-01-13T08:00:00Z",labels:{type:"security",component:"ssl"}}];const q={class:"incidents"},G={class:"page-header"},J={class:"actions"},K={key:0,class:"error-message"},Q={class:"incidents-container"},V={class:"card"},W={class:"incident-id"},X={class:"actions-group"},Y={key:0,class:"incident-details"},ee={class:"detail-row"},ae={class:"incident-id"},te={class:"detail-row"},le={class:"detail-row"},se={class:"description"},ie={class:"detail-row"},ne={class:"detail-row"},oe={class:"detail-row"},de={key:0,class:"detail-row"},re={key:1,class:"detail-row"},ce={key:2,class:"detail-row"},ue={key:3,class:"detail-row"},ve={class:"labels-container"},pe=w(e({__name:"Incidents",setup(e){const a=c(null),l=c(!1),{incidents:i,loading:g,error:w,loadIncidents:S,acknowledgeIncident:T,resolveIncident:D}=function(){const e=c([]),a=c(!1),t=c(null),l=async()=>{try{a.value=!0,t.value=null;const l=await f.getIncidents();e.value=l.sort((e,a)=>new Date(a.created_at).getTime()-new Date(e.created_at).getTime())}catch(l){e.value=H.sort((e,a)=>new Date(a.created_at).getTime()-new Date(e.created_at).getTime()),t.value=null}finally{a.value=!1}};return{incidents:e,loading:a,error:t,loadIncidents:l,getIncident:async e=>{try{return t.value=null,await f.getIncident(e)}catch(a){return t.value=a instanceof Error?a.message:"Failed to get incident",null}},acknowledgeIncident:async(a,l)=>{try{t.value=null;const s={assignee_id:l};await f.acknowledgeIncident(a,s);const i=e.value.findIndex(e=>e.id===a);-1!==i&&(e.value[i]={...e.value[i],status:"acknowledged",assignee_id:l,acknowledged_at:(new Date).toISOString(),updated_at:(new Date).toISOString()})}catch(s){throw t.value=s instanceof Error?s.message:"Failed to acknowledge incident",s}},resolveIncident:async a=>{try{t.value=null,await f.resolveIncident(a);const l=e.value.findIndex(e=>e.id===a);-1!==l&&(e.value[l]={...e.value[l],status:"resolved",resolved_at:(new Date).toISOString(),updated_at:(new Date).toISOString()})}catch(l){throw t.value=l instanceof Error?l.message:"Failed to resolve incident",l}},refresh:l}}(),z=[{key:"id",label:"ID",sortable:!0,width:"120px"},{key:"title",label:"Title",sortable:!0},{key:"severity",label:"Severity",sortable:!0,width:"120px",align:"center"},{key:"status",label:"Status",sortable:!0,width:"120px",align:"center"},{key:"created_at",label:"Created",sortable:!0,width:"180px"},{key:"duration",label:"Duration",width:"120px"},{key:"actions",label:"Actions",width:"200px",align:"center"}],A=e=>{a.value=e,l.value=!0},Z=()=>{l.value=!1,a.value=null},O=async e=>{try{await T(e,"current_user")}catch(a){alert("Failed to acknowledge incident")}},j=async e=>{var t;try{await D(e),(null==(t=a.value)?void 0:t.id)===e&&Z()}catch(l){alert("Failed to resolve incident")}},L=e=>{A(e)};return y(()=>{S()}),(e,c)=>{var y;return n(),t("div",q,[u("div",G,[c[2]||(c[2]=u("h2",null,"Incidents",-1)),u("div",J,[b(x,{onClick:o(S),loading:o(g),variant:"primary"},{default:_(()=>[r(d(o(g)?"Loading...":"Refresh"),1)]),_:1},8,["onClick","loading"])])]),o(w)?(n(),t("div",K,d(o(w)),1)):s("",!0),u("div",Q,[u("div",V,[b(U,{columns:z,data:o(i),loading:o(g),"empty-message":"No incidents found",hoverable:"",onRowClick:L},{"cell-id":_(({value:e})=>[u("code",W,d(String(e||"").substring(0,8)),1)]),"cell-severity":_(({value:e})=>[b($,{severity:String(e||"info"),size:"sm"},null,8,["severity"])]),"cell-status":_(({value:e})=>[b(B,{status:String(e||"open"),size:"sm"},null,8,["status"])]),"cell-created_at":_(({value:e})=>[r(d(o(C)(String(e||""))),1)]),"cell-duration":_(({row:e})=>[r(d(o(h)(e.created_at,e.resolved_at)),1)]),"cell-actions":_(({row:e})=>[u("div",X,[b(x,{size:"sm",variant:"primary",onClick:m(a=>A(e),["stop"])},{default:_(()=>[...c[3]||(c[3]=[r(" Details ",-1)])]),_:1},8,["onClick"]),"open"===e.status?(n(),k(x,{key:0,size:"sm",variant:"warning",onClick:m(a=>O(e.id),["stop"])},{default:_(()=>[...c[4]||(c[4]=[r(" Acknowledge ",-1)])]),_:1},8,["onClick"])):s("",!0),"resolved"!==e.status?(n(),k(x,{key:1,size:"sm",variant:"success",onClick:m(a=>j(e.id),["stop"])},{default:_(()=>[...c[5]||(c[5]=[r(" Resolve ",-1)])]),_:1},8,["onClick"])):s("",!0)])]),_:1},8,["data","loading"])])]),b(I,{show:l.value,title:`Incident Details - ${(null==(y=a.value)?void 0:y.id.substring(0,8))||""}`,onClose:Z},{footer:_(()=>{var e,t;return["open"===(null==(e=a.value)?void 0:e.status)?(n(),k(x,{key:0,variant:"warning",onClick:c[0]||(c[0]=e=>a.value&&O(a.value.id))},{default:_(()=>[...c[16]||(c[16]=[r(" Acknowledge ",-1)])]),_:1})):s("",!0),"resolved"!==(null==(t=a.value)?void 0:t.status)?(n(),k(x,{key:1,variant:"success",onClick:c[1]||(c[1]=e=>a.value&&j(a.value.id))},{default:_(()=>[...c[17]||(c[17]=[r(" Resolve ",-1)])]),_:1})):s("",!0),b(x,{variant:"secondary",onClick:Z},{default:_(()=>[...c[18]||(c[18]=[r(" Close ",-1)])]),_:1})]}),default:_(()=>[a.value?(n(),t("div",Y,[u("div",ee,[c[6]||(c[6]=u("strong",null,"ID:",-1)),u("code",ae,d(a.value.id),1)]),u("div",te,[c[7]||(c[7]=u("strong",null,"Title:",-1)),r(" "+d(a.value.title),1)]),u("div",le,[c[8]||(c[8]=u("strong",null,"Description:",-1)),u("p",se,d(a.value.description||"No description available"),1)]),u("div",ie,[c[9]||(c[9]=u("strong",null,"Severity:",-1)),b($,{severity:a.value.severity,size:"md","show-icon":""},null,8,["severity"])]),u("div",ne,[c[10]||(c[10]=u("strong",null,"Status:",-1)),b(B,{status:a.value.status,size:"md"},null,8,["status"])]),u("div",oe,[c[11]||(c[11]=u("strong",null,"Created:",-1)),r(" "+d(o(C)(a.value.created_at)),1)]),a.value.acknowledged_at?(n(),t("div",de,[c[12]||(c[12]=u("strong",null,"Acknowledged:",-1)),r(" "+d(o(C)(a.value.acknowledged_at)),1)])):s("",!0),a.value.resolved_at?(n(),t("div",re,[c[13]||(c[13]=u("strong",null,"Resolved:",-1)),r(" "+d(o(C)(a.value.resolved_at)),1)])):s("",!0),a.value.assignee_id?(n(),t("div",ce,[c[14]||(c[14]=u("strong",null,"Assignee:",-1)),r(" "+d(a.value.assignee_id),1)])):s("",!0),a.value.labels&&Object.keys(a.value.labels).length>0?(n(),t("div",ue,[c[15]||(c[15]=u("strong",null,"Labels:",-1)),u("div",ve,[(n(!0),t(v,null,p(Object.entries(a.value.labels),([e,a])=>(n(),t("span",{key:e,class:"label-tag"},[u("strong",null,d(e)+":",1),r(" "+d(a),1)]))),128))])])):s("",!0)])):s("",!0)]),_:1},8,["show","title"])])}}}),[["__scopeId","data-v-ddfb2f7c"]]);export{pe as default};
