import{d as B,w as R,o as V,c as j,a as M,T as x,b as D,e as O,f as a,g as i,h as e,t as n,r as T,i as l,_ as N,j as m,k as q,F as S,l as A,m as I,n as _,p as C,u as h,q as $,s as z}from"./index-C4HpvfRn.js";const K={class:"modal"},P={class:"modal-header"},U={key:0},G={class:"modal-body"},H={key:0,class:"modal-footer"},J=B({__name:"Modal",props:{show:{type:Boolean},title:{}},emits:["close"],setup(k,{emit:b}){const u=k,g=b,s=()=>{g("close")},y=d=>{d.key==="Escape"&&u.show&&s()},w=d=>{var c;(c=d.target)!=null&&c.classList.contains("modal-overlay")&&s()},p=d=>{d?(document.body.style.overflow="hidden",document.addEventListener("keydown",y)):(document.body.style.overflow="unset",document.removeEventListener("keydown",y))};return R(()=>u.show,d=>{p(d)}),V(()=>{p(!1)}),(d,c)=>(l(),j(O,{to:"body"},[M(x,{name:"modal"},{default:D(()=>[k.show?(l(),a("div",{key:0,class:"modal-overlay",onClick:w},[e("div",K,[e("div",P,[k.title?(l(),a("h3",U,n(k.title),1)):i("",!0),e("button",{class:"modal-close",onClick:s,"aria-label":"Close modal"}," Ã— ")]),e("div",G,[T(d.$slots,"default",{},void 0,!0)]),d.$slots.footer?(l(),a("div",H,[T(d.$slots,"footer",{},void 0,!0)])):i("",!0)])])):i("",!0)]),_:3})]))}}),Q=N(J,[["__scopeId","data-v-60cb1036"]]),W={class:"incidents"},X={class:"page-header"},Y={class:"actions"},Z=["disabled"],ee={key:0,class:"error-message"},te={class:"incidents-container"},se={class:"card"},le={key:0,class:"loading"},oe={key:1,class:"table"},ae={class:"actions-group"},ne=["onClick"],de=["onClick"],ie=["onClick"],re={key:2,class:"no-data"},ue={key:0,class:"incident-details"},ce={class:"detail-row"},ve={class:"detail-row"},_e={class:"detail-row"},be={class:"description"},ge={class:"detail-row"},ye={class:"detail-row"},we={class:"detail-row"},ke={key:0,class:"detail-row"},me={key:1,class:"detail-row"},he={key:2,class:"detail-row"},pe={key:3,class:"detail-row"},fe={class:"labels-container"},Ce=B({__name:"Incidents",setup(k){const b=m([]),u=m(!0),g=m(null),s=m(null),y=m(!1),w=async()=>{try{u.value=!0,g.value=null,b.value=await I.getIncidents(),b.value.sort((r,t)=>new Date(t.created_at).getTime()-new Date(r.created_at).getTime())}catch(r){g.value="Error loading incidents",console.error("Error loading incidents:",r)}finally{u.value=!1}},p=()=>{w()},d=r=>{s.value=r,y.value=!0},c=()=>{y.value=!1,s.value=null},L=async r=>{try{await I.acknowledgeIncident(r,{assignee_id:"current_user"}),await w()}catch(t){console.error("Error acknowledging incident:",t),alert("Failed to acknowledge incident")}},E=async r=>{var t;try{await I.resolveIncident(r),await w(),((t=s.value)==null?void 0:t.id)===r&&c()}catch(f){console.error("Error resolving incident:",f),alert("Failed to resolve incident")}};return q(()=>{w()}),(r,t)=>{var f;return l(),a("div",W,[e("div",X,[t[2]||(t[2]=e("h2",null,"Incidents",-1)),e("div",Y,[e("button",{onClick:p,class:"btn btn-primary",disabled:u.value},n(u.value?"Loading...":"Refresh"),9,Z)])]),g.value?(l(),a("div",ee,n(g.value),1)):i("",!0),e("div",te,[e("div",se,[u.value?(l(),a("div",le," Loading incidents... ")):b.value.length>0?(l(),a("table",oe,[t[3]||(t[3]=e("thead",null,[e("tr",null,[e("th",null,"ID"),e("th",null,"Title"),e("th",null,"Severity"),e("th",null,"Status"),e("th",null,"Created"),e("th",null,"Duration"),e("th",null,"Actions")])],-1)),e("tbody",null,[(l(!0),a(S,null,A(b.value,o=>(l(),a("tr",{key:o.id},[e("td",null,n(o.id.substring(0,8)),1),e("td",null,n(o.title),1),e("td",null,[e("span",{class:C(`severity-badge severity-${o.severity.toLowerCase()}`)},n(o.severity),3)]),e("td",null,[e("span",{class:C(`status-badge status-${o.status.toLowerCase().replace(" ","-")}`)},n(o.status),3)]),e("td",null,n(h($)(o.created_at)),1),e("td",null,n(h(z)(o.created_at,o.resolved_at)),1),e("td",null,[e("div",ae,[e("button",{class:"btn btn-primary btn-sm",onClick:v=>d(o)}," Details ",8,ne),o.status==="open"?(l(),a("button",{key:0,class:"btn btn-warning btn-sm",onClick:v=>L(o.id)}," Acknowledge ",8,de)):i("",!0),o.status!=="resolved"?(l(),a("button",{key:1,class:"btn btn-success btn-sm",onClick:v=>E(o.id)}," Resolve ",8,ie)):i("",!0)])])]))),128))])])):(l(),a("div",re," No incidents found "))])]),M(Q,{show:y.value,title:`Incident Details - ${((f=s.value)==null?void 0:f.id.substring(0,8))||""}`,onClose:c},{footer:D(()=>{var o,v;return[((o=s.value)==null?void 0:o.status)==="open"?(l(),a("button",{key:0,class:"btn btn-warning",onClick:t[0]||(t[0]=F=>s.value&&L(s.value.id))}," Acknowledge ")):i("",!0),((v=s.value)==null?void 0:v.status)!=="resolved"?(l(),a("button",{key:1,class:"btn btn-success",onClick:t[1]||(t[1]=F=>s.value&&E(s.value.id))}," Resolve ")):i("",!0),e("button",{class:"btn btn-secondary",onClick:c}," Close ")]}),default:D(()=>[s.value?(l(),a("div",ue,[e("div",ce,[t[4]||(t[4]=e("strong",null,"ID:",-1)),_(" "+n(s.value.id),1)]),e("div",ve,[t[5]||(t[5]=e("strong",null,"Title:",-1)),_(" "+n(s.value.title),1)]),e("div",_e,[t[6]||(t[6]=e("strong",null,"Description:",-1)),e("p",be,n(s.value.description||"No description available"),1)]),e("div",ge,[t[7]||(t[7]=e("strong",null,"Severity:",-1)),e("span",{class:C(`severity-badge severity-${s.value.severity.toLowerCase()}`)},n(s.value.severity),3)]),e("div",ye,[t[8]||(t[8]=e("strong",null,"Status:",-1)),e("span",{class:C(`status-badge status-${s.value.status.toLowerCase().replace(" ","-")}`)},n(s.value.status),3)]),e("div",we,[t[9]||(t[9]=e("strong",null,"Created:",-1)),_(" "+n(h($)(s.value.created_at)),1)]),s.value.acknowledged_at?(l(),a("div",ke,[t[10]||(t[10]=e("strong",null,"Acknowledged:",-1)),_(" "+n(h($)(s.value.acknowledged_at)),1)])):i("",!0),s.value.resolved_at?(l(),a("div",me,[t[11]||(t[11]=e("strong",null,"Resolved:",-1)),_(" "+n(h($)(s.value.resolved_at)),1)])):i("",!0),s.value.assignee_id?(l(),a("div",he,[t[12]||(t[12]=e("strong",null,"Assignee:",-1)),_(" "+n(s.value.assignee_id),1)])):i("",!0),s.value.labels&&Object.keys(s.value.labels).length>0?(l(),a("div",pe,[t[13]||(t[13]=e("strong",null,"Labels:",-1)),e("div",fe,[(l(!0),a(S,null,A(Object.entries(s.value.labels),([o,v])=>(l(),a("span",{key:o,class:"label-tag"},[e("strong",null,n(o)+":",1),_(" "+n(v),1)]))),128))])])):i("",!0)])):i("",!0)]),_:1},8,["show","title"])])}}}),Ie=N(Ce,[["__scopeId","data-v-004c3f6b"]]);export{Ie as default};
